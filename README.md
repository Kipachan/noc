# Network output checker (noc)

Данный комплект python скриптов предназначен для формирования списка уникальных DNS-имен на которые отправляет запросы локальный хост (с использованием tcpdump). Затем полученный список сопоставляется с журналом auditd, который настроен на аудит сетевых системных вызовов. Результатом сопоставления является xml в который фиксируется информация о совершенных запросах.  

## Описание модулей:
### config.py

Этот модуль используется для настройки всех скриптов. Представляет собой набор переменных. Все переменные хранятся здесь.

### tcpdump_parser.py

Данный модуль реализует захват трафика, его парсинг и запись результата в текстовый файл в виде списка.

### auditd_parser.py

Модуль открывает список DNS-имен, который сформировал tcpdump_parser.py и используя функцию разрешения dns-имен в ip-адреса (модуль net_dict.py) формирует словарь {ip:dns}.
Затем на основе полученного словаря, скрипт осуществляет парсинг журнала auditd и формирует массив событий. Полученный массив сохраняется в XML файл (create_xml.py).

### auditd_events_xml_parser.py

Этот модуль парсит xml файлы созданные в резульатте работы auditd_parser.py и формирует xml файл из уникальных событий. Он нужен если скопилось несколько xml файлов и появилась необходимость объеденить их в один файл и исключить неуникальные события.

### archive.py

Модуль архивирует xml файлы в *.tar.xz архив.

### check_dir.py

Проверяет существование каталогов. Используется модулями: tcpdump_parser.py, auditd_parser.py, auditd_events_xml_parser.py

### check_user.py

Проверяет от какого имени пользователя запускается модуль tcp_dump_parser.py (должен запускаться от root).

### create_xml.py

Создает xml файл используя библиотеку xml.etree.ElementTree. используется модулем auditd_parser.py.

### net_dict.py

Модуль применяется для разрешения dns-имен в ip-адреса с помощью утилиты getent. Используется модулем auditd_parser.py.

### permission_list.py

Модуль представляющий белый\черный списки dns-имен. По-умолчанию применяется черный список (decline). Используется модулем net_dict.py. 
Черный список - decline применяется для исключения (по каким-либо причинам) DNS-имен из списка сформированного модулем tcpdump_parser.py.  
Белый список - permit применяется для использования в net_dict.py только определенных dns-имен. Напрмиер если необходимо получить информацию только по одному конкретному dns-имени.

## Расширенные модули (каталог extend)

Данные модули никак не зависят от основного блока скриптов описанных выше и нужны для работы с результатми. 

### lsx.py

Применяется для того чтобы разбить один xml файл на несколько. В зависимостей от необходимостей в модуле можно указать максимальное кол-во элементов (строк) в новых xml файлах.
Может быть полезным если например auditd_events_xml_parser.py сформировал слишком большой xml (например 1Гб) и работа с ним весьма затруднительна, то lsx.py разделит его на необходимое кол-во файлов поменьше.






